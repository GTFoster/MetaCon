---
title: "Plotting_Scaffold"
author: "Grant Foster"
date: "2023-06-21"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
```

```{r}
load("mini_simulationNegative.Rda")
```

```{r}
str(list_results)

run1 <- list_results[[1]]
tail(run1$plants)


```
Mean Niche Breadth
```{r}
pcom_abund <- as.data.frame(run1$plants) %>% group_by(., V2) %>% summarize(., across(everything(), sum)) #create community abundance matrix by summing across sites (V2)

WmeanVar <- apply(pcom_abund[,3:ncol(pcom_abund)]/rowSums(pcom_abund[,3:ncol(pcom_abund)]), MARGIN=1, FUN=function(X){ #Input into this function is the relative abundances of each species
  sum(X*run1$p_traitV) #multiply the mean trait value by relative abundances at each timestep, then return the sum
  }
)

plot(x=1:1001, y=WmeanVar, type="l", xlab="time", ylab="Abundace-Weighted Mean Trait Variance", main="Plants")

acom_abund <- as.data.frame(run1$animals) %>% group_by(., V2) %>% summarize(., across(everything(), sum)) #create community abundance matrix by summing across sites (V2)

WmeanVar <- apply(acom_abund[,3:ncol(acom_abund)]/rowSums(acom_abund[,3:ncol(acom_abund)]), MARGIN=1, FUN=function(X){ #Input into this function is the relative abundances of each species
  sum(X*run1$a_traitV) #multiply the mean trait value by relative abundances at each timestep, then return the sum
  }
)
plot(x=1:1001, y=WmeanVar, type="l", xlab="time", ylab="Abundace-Weighted Mean Trait Variance", main="Animals")
```
Who's successfully colonizing?
```{r}

```

Community vs Population Stability?
```{r}

```

